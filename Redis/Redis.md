# 一、Redis的数据类型

Redis 作为一款高性能的 ***\*内存数据库\****，提供了丰富的数据类型来满足不同业务场景需求，其中最核心、最常用的 5 种基础类型分别是：***\*String（字符串）、Hash（哈希）、List（列表）、Set（集合）、Sorted Set（有序集合）\****。这 5 种类型均基于 ***\*键值对（Key-Value）\**** 结构，且支持灵活的操作命令。

# 二、Redis的集群部署

Redis 集群通常由多个节点组成，至少需要 3 个主节点，每个主节点可以有一个或多个从节点。这种结构提供了数据分片、高可用和负载均衡的能力。

# 三、Redis的缓存失效时间

**1. 设置方法：**

- **`EXPIRE key seconds`**：为已存在的 key 设置秒级过期时间。
- **`SET key value EX seconds`**：（推荐）在设置值的同时指定秒级过期时间，这是一个原子操作。
- 类似命令还有 `PEXPIRE`（毫秒）、`EXPIREAT`（到期时间戳）。

**2. 工作原理：**

- **惰性删除**：当客户端访问一个 key 时，才检查它是否过期。如果过期，则立即删除并返回空。
- **定期删除**：Redis 会每隔一段时间（默认每秒10次）随机抽查一些设置了过期时间的 key，并删除其中已过期的。

**3. 关键特性：**

- 过期时间到期后，key 会被自动从数据库中删除。
- 使用 **`TTL key`** 命令可以查询 key 的剩余生存时间（秒）。
- 重新用 `SET` 命令为 key 赋值会**清除**其原有的过期时间（除非使用 Redis 6.0+ 的 `KEEPTTL` 选项）。

### 最佳实践

**永远为你不知道何时会失效的缓存设置一个过期时间**，这是防止内存无限增长的最重要规则。根据数据更新频率，选择一个合理的时长（例如，会话数据 30 分钟，基础数据 24 小时）

# 四、Redis的缓存穿透、缓存击穿、缓存雪崩

缓存穿透是指 客户端请求的 key 在缓存（Redis）和数据库中都不存在，导致请求 “穿透” 缓存，直接频繁访问数据库。

缓存击穿是指 一个热点 key在缓存中过期的瞬间，恰好有大量请求同时访问该 key，导致所有请求都穿透到数据库，瞬间压垮数据库。

缓存雪崩是指 在某一时间段，缓存中大量 key 集中过期，或 Redis 集群整体故障，导致大量请求全部穿透到数据库，引发数据库崩溃。

比对总结

| ***\*问题类型\**** | ***\*核心区别（触发条件）\****        | ***\*影响范围\****  | ***\*核心解决方案思路\****             |
| ------------------ | ------------------------------------- | ------------------- | -------------------------------------- |
| 缓存穿透           | 请求的 key 在缓存和数据库中均不存在。 | 针对无效 key 的请求 | 过滤无效 key（布隆过滤器）、缓存空值。 |
| 缓存击穿           | 热点 key 过期瞬间，大量并发请求访问。 | 单个热点 key        | 互斥锁、热点 key 永不过期。            |
| 缓存雪崩           | 大量 key 集中过期或 Redis 集群故障。  | 大量 key 或整体缓存 | 过期时间随机化、Redis 高可用、限流     |